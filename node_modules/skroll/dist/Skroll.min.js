!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Skroll=t()}(this,function(){"use strict";String.prototype.startsWith||(String.prototype.startsWith=function(e){return this.slice(0,e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e){return-1!==this.indexOf(e,this.length-e.length)});var e,t,n=null,i={hideAsInit:!0,mode:1,itemHeightFixed:!1,_itemHeight:0,_liveRangeOffset:0,get liveRangeOffset(){return 0!==this._liveRangeOffset?this._liveRangeOffset:(this._liveRangeOffset=Math.ceil(this.screenMaxHeight/a.minHeight)*this.liveRatio,this._liveRangeOffset)},set liveRangeOffset(e){this._liveRangeOffset=e},_liveRange:0,get liveRange(){return 0!==this._liveRange?this._liveRange:(this._liveRange=Math.ceil(this.screenMaxHeight/a.minHeight)*(1+this.liveRatio),this._liveRange)},set liveRange(e){this._liveRange=e},liveRatio:1,displayNeeded:!1,ifRequestAnimationFrame:!1,screenMaxHeight:window.screen.height,usePaddingOrBlank:1},a={touchStartLock:!1,touchEndLock:!1,showBegin:0,showEnd:0,listLen:0,begin:0,pos:0,dir:0,hIndex:[],hIndexOf:function(e,t,n){if(i.itemHeightFixed)return 0===i._itemHeight&&(i._itemHeight=t[e].offsetHeight),this.hIndex[e]=i._itemHeight,i._itemHeight;if(!0===n)return this.hIndex[e];if(0===i.mode)return this.hIndex[e];if(e<this.pSafeTo)return this.hIndex[e];if(!1===this.vIndex[e])return this.hIndex[e];var a=t[e].offsetHeight;return this.hIndex[e]=a,a},pIndex:[],pIndexOf:function(e,t,a,r,o){if(i.itemHeightFixed){var s=i._itemHeight;return 0===s&&(s=i._itemHeight=a[e].offsetHeight),s*=e-1,this.pIndex[e]=s,s}if(!0===o)return this.pIndex[e];if(0===i.mode)return this.pIndex[e];if(0===e)return 0;var l;if(e<=this.pSafeTo)l=this.pIndex[e];else{if(0===r)l=this.pIndexOf(e-1,t,a,r)+this.hIndexOf(e-1,a),this.pSafeTo=e;else if(1===r)l=e===t?n.offsetHeight:this.pIndexOf(e+1,t,a,r)-this.hIndexOf(e,a),this.pIndex[e]===l&&(this.pSafeTo=e);else{if(-1!==r)return this.pIndex[e];l=a[e].offsetTop,this.pIndex[e]===l&&(this.pSafeTo=e)}this.pIndex[e]=l}return l},pUnsafeAll:function(){this.pSafeTo=0},pSafeTo:0,vIndex:[],dIndex:[],rIndex:[],preHeight:0,updatePreHeight:function(){0===i.usePaddingOrBlank?n.style.paddingTop=a.preHeight+"px":e.style.height=a.preHeight+"px"},subHeight:0,updateSubHeight:function(){0===i.usePaddingOrBlank?n.style.paddingBottom=a.subHeight+"px":t.style.height=a.subHeight+"px"},minHeight:1e6},r=function(){if(0===i.usePaddingOrBlank)return n.children;var e=n.children;return Array.prototype.slice.call(e,1,e.length-1)},o=function(e,t){var n="";return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,"").getPropertyValue(t):e.currentStyle&&(t=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),n=e.currentStyle[t]),n},s=function(){if(a.preHeight=0,a.subHeight=0,1===i.usePaddingOrBlank){var r="width:0;height:0;padding:0;border:0;margin:0;";(e=document.createElement("div")).setAttribute("style",r),n.insertBefore(e,n.children[0]),(t=document.createElement("div")).setAttribute("style",r),n.appendChild(t),n.appendChild=function(e){n.insertBefore(e,t)}}},l=function(e,t){for(var n,r=0,s=1e6,l=0;l<e;l++)t[l].setAttribute("data-key",l),(n=i.itemHeightFixed?a.hIndexOf(l,t):t[l].offsetHeight)<s&&n>12&&(s=n),a.pIndex[l]=r,a.hIndex[l]=n,r+=n,a.vIndex[l]=!0,i.displayNeeded&&(a.dIndex[l]=o(t[l],"display"));a.showBegin=0,a.showEnd=e-1,a.minHeight=1e6===s?12:s},d=function(e,t,n){var i,r=-1;if(a.pIndexOf(a.begin,t,n,-1),0===a.dir){for(i=a.begin;i>=0;i--)if(!0!==a.rIndex[i]&&(o=a.pIndexOf(i,t,n,1))<=e){r=i;break}r<0&&(r=0)}else{var o;for(i=a.begin;i<t;i++)if(!0!==a.rIndex[i]&&(o=a.pIndexOf(i,t,n,0),a.pSafeTo=i,o>e)){r=i-1;break}r<0&&(r=t-1)}return r},h=function(){var e,t=r(),n=t.length,i=a.pos,o=a.begin,s=-1;if(a.pIndexOf(o,n,t)>i){for(s=0,e=o-1;e>=0;e--)if(!0!==a.rIndex[e]&&a.pIndexOf(e,n,t,1)<=i){s=e;break}}else for(s=n-1,e=o+1;e<n;e++)if(!0!==a.rIndex[e]){if(a.pIndexOf(e,n,t,0)>i){s=e-1;break}a.pSafeTo=e}return s},f=function(e,t){var n=r(),o=n.length,s=h();!0===t&&v(s,s-i.liveRangeOffset,o,n,!0,!e),c(s,s+i.liveRange-1,o,n,!0,!e),a.begin=s,a.pUnsafeAll()},u=function(e,t){var n=r();e||(e=a.listLen),t||(t=n.length);var s=a.vIndex[e-1];if(e<t){a.listLen=t;var l=a.pIndexOf(e-1,e,n,0)+a.hIndexOf(e-1,n);a.pSafeTo=e-1;for(var d,h=e;h<t;h++)!0!==a.rIndex[h]&&(n[h].setAttribute("data-key",h),d=i.itemHeightFixed?a.hIndexOf(h,n):n[h].offsetHeight,a.pIndex[h]=l,a.hIndex[h]=d,l+=d,a.vIndex[h]=s,i.displayNeeded&&(a.dIndex[h]=o(n[h],"display")),s||(n[h].style.display="none",a.subHeight+=d));a.pUnsafeAll(),s||a.updateSubHeight()}},p=function(e,t){e!==t&&u(e,t)},g=function(e){if(a.touchStartLock)window.setTimeout(function(){g(e)},100);else{a.touchEndLock=!0;var t=r(),n=t.length;p(a.listLen,n);var o=0;if(e<0&&(e=-e),e!==a.pos){e<a.pos?a.dir=0:a.dir=1,a.pos=e,o=d(e,n,t);var s;0===a.dir?(s=o-i.liveRangeOffset,v(a.begin,s,n,t,!0)):(s=o+i.liveRange-1,c(a.begin,s,n,t,!0)),a.begin=o,a.touchEndLock=!1,a.pUnsafeAll()}else a.touchEndLock=!1}},c=function(e,t,n,r,o,s){e<0&&(e=0),t>n-1&&(t=n-1);for(var l=i.displayNeeded,d=e;d<=t;d++)!0!==a.rIndex[d]&&(a.vIndex[d]||(a.vIndex[d]=!0,r[d].style.display=l?a.dIndex[d]:"block",a.subHeight-=a.hIndexOf(d,r)));if(a.showEnd=t,o)for(d=t+1;d<n;d++)if(!0!==a.rIndex[d]){if(!a.vIndex[d]){if(s)continue;break}var h=a.hIndexOf(d,r);r[d].style.display="none",a.vIndex[d]=!1,a.subHeight+=h}a.subHeight<0&&(a.subHeight=0),a.updateSubHeight()},v=function(e,t,n,r,o,s){t<0&&(t=0),e>n-1&&(e=n-1);for(var l=i.displayNeeded,d=e;d>=t;d--)!0!==a.rIndex[d]&&(a.vIndex[d]||(a.vIndex[d]=!0,r[d].style.display=l?a.dIndex[d]:"block",a.preHeight-=a.hIndexOf(d,r)));if(a.showBegin=t,o)for(d=t-1;d>=0;d--)if(!0!==a.rIndex[d]){if(!a.vIndex[d]){if(s)continue;break}var h=a.hIndexOf(d,r);r[d].style.display="none",a.vIndex[d]=!1,a.preHeight+=h}a.preHeight<0&&(a.preHeight=0),a.updatePreHeight()},m=function(e,t){var n=h(),i=a.listLen,o=a.pIndexOf(n,i,r()),s=0;if(t+=e,o<t){for(l=n+1;l<i;l++)if(a.pIndexOf(l,i,r(),0)>t){s=l-1;break}l===i&&(s=i-1)}else if(o===t)s=n;else for(var l=n-1;l>=0;l--)if(a.pIndexOf(l,i,r(),1)<=t){s=l;break}return r()[s]},x=function(e,t,n,r){if(0!==i.mode&&!i.itemHeightFixed){"number"==typeof e&&(e=m(e,t));var o=parseInt(e.getAttribute("data-key")),s=e.offsetHeight-a.hIndex[o];if(0!==s){for(var l=o,d=a.hIndex.length;l<d;l++)!0!==a.rIndex[l]&&(a.hIndex[l]+=s,a.pIndex[l]+=s);f(!!n,r)}}},I={onInit:function(e,t){i.itemHeightFixed=t.itemHeightFixed||i.itemHeightFixed,i.usePaddingOrBlank=2===t.filler?1:0;var o=e.children;if(o&&o.length){n=e;var d=o.length;if(l(d,o),s(),1===i.usePaddingOrBlank&&(o=r()),i.hideAsInit){var h=0-i.liveRangeOffset,f=0+i.liveRange-1;h<0&&(h=0),f>=d&&(f=d-1);var u;for(u=h-1;u>=0;u--)a.preHeight+=a.hIndexOf(u,o),o[u].style.display="none",a.vIndex[u]=!1;for(a.updatePreHeight(),u=f+1;u<d;u++)a.subHeight+=a.hIndexOf(u,o),o[u].style.display="none",a.vIndex[u]=!1;a.updateSubHeight(),a.showBegin=h,a.showEnd=f}a.listLen=d}},onScrollStart:function(e,t){x(t.touchY,-t.position,!1,!1)},onScrollEnd:function(e,t){g(-t.endPosition)},onElementUpdate:function(e){x(e)},onElementRemove:function(e){var t=parseInt(e.getAttribute("data-key"));a.rIndex[t]=!0},onElementAdd:function(e){u()}};return function(e,t){t||(t={}),!1!==t.autoHide&&(t.autoHide=!0);var n,i,a,r,o,s,l,d,h,f,u,p,g,c,v,m,x,y,b,T=!1,H=!1,w=0,O=function(){if(0===w){var e=n.children.length;if(2===k&&(e-=2),e<=0)return 0;w=n.children[2===k?1:0].offsetHeight}return w},k=t.filler||1,S=0,M={page:0,parent:0,bar:0,foo:0},R=4e3,E=6e3,_=0,A=[],P=[],B=[],L={draggable:!1,minHeight:8,hideDelay:1e3,mode:1},Y=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},D={hideTimeout:null,thenX:null,nowX:null,thenY:null,nowY:null,startX:null,startY:null,totalDistX:null,totalDistY:null,startTop:null,startTime:null,lastMoveTime:null,lastLastMoveTime:null,scrollPosition:0},F=0,X=function(){return 0===F&&C(),F},C=function(e){F=n.parentNode.clientHeight},N=function(){return H?(2===k?n.children.length-2:n.children.length)*O():n.clientHeight};window.addEventListener("resize",C,!1);var U={updateHeights:function(){M.parent=M.foo=X(),M.page=N(),M.bar=Math.max(M.foo*M.parent/M.page,L.minHeight)},lockPageHeight:function(e){e>M.page?this.unlockPageHeight():(n.style.height=e+"px",n.style.overflow="hidden")},unlockPageHeight:function(){n.style.height="",n.style.overflow=""},getScrollBar:function(){if(i)return i;var e=n.parentNode;if(!e)return null;var t=e.getElementsByClassName("scroll-foo");if(t&&t.length)t=t[0].children[0];else{var a=document.createElement("div");t=document.createElement("div"),a.className="scroll-foo",a.setAttribute("style","position: absolute;top: 0;right: 0;width: 8px;height: 100%;background-color: rgba(204, 204, 204, 0.6);z-index: 100;                    -webkit-transition: opacity 0.3s ease;                    -moz-transition: opacity 0.3s ease;                    -ms-transition: opacity 0.3s ease;                    -o-transition: opacity 0.3s ease;                    transition: opacity 0.3s ease;"+(1===L.mode?"opacity: 0;display: none;":"")),t.setAttribute("style","position: relative;top: 0;right: 0;background-color: #666;width: 8px;height: 0;border-radius: 4px;"),a.appendChild(t),e.appendChild(a),U.updateHeights(),t.style.height=M.bar+"px",t.addEventListener("touchstart",function(e){if(L.draggable){var t=e.changedTouches[0];D.thenX=D.nowX=D.startX=t.pageX,D.thenY=D.nowY=D.startY=t.pageY,D.startTime=D.lastLastMoveTime=D.lastMoveTime=Date.now(),D.startTop=D.scrollPosition=U.stopTranslate(this,D.scrollPosition,"bar"),_=U.stopTranslate(n,_),U.updateHeights(),1===L.mode&&(this.parentNode.style.display="block",this.parentNode.style.opacity="1",null!=D.hideTimeout&&window.clearTimeout(D.hideTimeout)),e.preventDefault()}},!1),t.addEventListener("touchmove",function(e){if(L.draggable&&!(M.bar>=M.foo)){var t=e.changedTouches[0],i=D.startTop+t.pageY-D.startY;i<0&&(i=0);var a=U.getMaxTranslate("bar",this);i>a&&(i=a),D.scrollPosition=U.setTranslate("bar",this,i,!0),D.thenX=D.nowX,D.nowX=t.pageX,D.thenY=D.nowY,D.nowY=t.pageY,D.lastLastMoveTime=D.lastMoveTime,D.lastMoveTime=Date.now(),U.setTranslate("page",n,-(M.page-M.parent)*(i/(M.foo-M.bar))),e.preventDefault()}},!1),t.addEventListener("touchend",function(e){L.draggable&&(1===L.mode&&(D.hideTimeout=window.setTimeout(function(){this.parentNode.style.opacity="0"}.bind(this),L.hideDelay)),e.preventDefault())},!1)}return i=t,t},calSpeed:function(e,t,n,i){var a=e.length;if(a<=0)return 0;if(1===a)return t[0]<=0?0:e[0]/t[0];if(a<4)return n/i;var r,o,s,l;for(r=s=0,o=l=0,f=1;f<=2;f++)r+=e[a-f],o+=t[a-f],s+=e[a-f-2],l+=t[a-f-2];if(a<6)return r/(u=(o+l)/2)*2-s/u;var d,h;d=h=0;for(var f=a-1-4;f>=a-6;f--)d+=e[f],h+=t[f];var u=(o+l+h)/3;return r/u+s/u-d/u},getMaxTranslate:function(e,t){return"page"===e?M.parent-M.page:M.foo-M.bar},_setT:function(e,t){e.style.transform=e.style.WebkitTransform="translate3d(0,"+t+"px,0)"},setTranslate:function(e,t,n,i){var a=n||0;i?a<0?a=0:a>this.getMaxTranslate(e,t)&&(a=this.getMaxTranslate(e,t)):a>0?a=0:a<this.getMaxTranslate(e,t)&&(a=this.getMaxTranslate(e,t));var r=a;return b?Y(function(e,t){return function(){U._setT(e,t)}}(t,a)):U._setT(t,a),r},_calTranslate:function(e,t,n){return parseFloat(e)+(t>0?1:-1)*t*t/(2*Math.abs(n))},_setTransitionClass:function(e,t,n,i,a,r){var o=!1===t?n:"transform "+t+"s cubic-bezier("+n+", "+i+", "+a+", "+r+")";return e.style.transition=e.style.WebkitTransition=o,o},updateTransition:function(e,t,n,i,a,r,o){i>0&&(i=-i);var s=r||0,l=o||this.getMaxTranslate(e,t),d=this._calTranslate(a,n,i),h=0;h=d>s?s-a:d<l?a-l:Math.abs(d-a);var f=(n=Math.abs(n))*n+2*i*h;f<0&&(f=0);var u=(Math.sqrt(f)-n)/i,p=n*u/h/3,g=p+1/3,c=this._setTransitionClass(t,u,1/3,p,1/3+1/3,g);return{position:this.setTranslate(e,t,d),distance:h,time:u,transition:c}},stopTranslate:function(e,t,n){var i;if(T){var a=(x-y)/1e3;i=m+(v*a+(v>0?-1:1)*R*a*a/2),n&&(i/=-M.page/M.foo),e.style.transform=e.style.WebkitTransform="translate3d(0,"+i+"px,0)"}else null==t?((i=e.style.transform)&&"none"!==i||(i=e.style.WebkitTransform),i&&"none"!==i&&(i=i.substring(i.indexOf(", ")+2,i.lastIndexOf(", ")))):i=t;return i&&"none"!==i||(i=0),e.style.transition=e.style.WebkitTransition="",parseFloat(i)}},W={names:["Init"],onInit:[],init:function(e,n){for(var i=0,a=this.onInit.length;i<a;i++)this.onInit[i](e,t,n)}},q={names:["Add","Remove","Update"],onAdd:[],onRemove:[],onUpdate:[],add:function(e){for(var t=0,n=this.onAdd.length;t<n;t++)this.onAdd[t](e)},remove:function(e){for(var t=0,n=this.onRemove.length;t<n;t++)this.onRemove[t](e)},update:function(e){for(var t=0,n=this.onUpdate.length;t<n;t++)this.onUpdate[t](e)}},z={names:["Start","Pause","Move","End"],onStart:[],onMove:[],onEnd:[],start:function(e,t){for(var n=0,i=this.onStart.length;n<i;n++)this.onStart[n](e,t)},move:function(e,t){for(var n=0,i=this.onMove.length;n<i;n++)this.onMove[n](e,t)},end:function(e,t){for(var n=0,i=this.onEnd.length;n<i;n++)this.onEnd[n](e,t)}};n=e,H=t.itemHeightFixed||H,R=t.acceleration||R,E=t.maxSpeed||E,L.mode=t.scrollBarMode||L.mode,b=!!t.raf,U.updateHeights(),a=t.plugins||[],t.autoHide&&a.push(I),function(){for(var e=W.names,t=null,n=0,i=a.length;n<i;n++){t=a[n];for(var r=0,o=e.length;r<o;r++)t["on"+e[r]]&&W["on"+e[r]].push(t["on"+e[r]])}e=z.names,t=null;for(var n=0,i=a.length;n<i;n++){t=a[n];for(var r=0,o=e.length;r<o;r++)t["onScroll"+e[r]]&&z["on"+e[r]].push(t["onScroll"+e[r]])}e=q.names,t=null;for(var n=0,i=a.length;n<i;n++){t=a[n];for(var r=0,o=e.length;r<o;r++)t["onElement"+e[r]]&&q["on"+e[r]].push(t["onElement"+e[r]])}}(),W.init(n),0!==L.mode&&U.getScrollBar(),n.addEventListener("touchstart",function(e){var t=e.changedTouches[0];if(l=h=r=t.pageX,d=f=o=t.pageY,x=p=u=Date.now(),s=_=U.stopTranslate(this,_),U.updateHeights(),0!==L.mode&&M.parent&&M.page&&M.parent<M.page){var n=U.getScrollBar();1===L.mode&&(n.parentNode.style.display="block",n.parentNode.style.opacity="1",null!=D.hideTimeout&&window.clearTimeout(D.hideTimeout)),n.style.height=M.bar+"px",D.scrollPosition=U.stopTranslate(n,D.scrollPosition,"bar")}T=!1,A=[],P=[],B=[],z.start(this,{position:s,touchY:o}),e.preventDefault()},!1),n.addEventListener("touchmove",function(e){if(!(M.page<=M.parent)){var t=e.changedTouches[0],n=s+t.pageY-o;n>0&&(n=0);var i=U.getMaxTranslate("page",this);n<i&&(n=i),_=U.setTranslate("page",this,n),l=h,h=t.pageX,d=f,f=t.pageY,p=u,u=Date.now(),A.push(h-l),P.push(f-d),B.push(u-p),0!==L.mode&&M.parent&&M.page&&U.setTranslate("bar",U.getScrollBar(),-(M.foo-M.bar)*(n/(M.page-M.parent)),!0),e.preventDefault()}},!1),n.addEventListener("touchend",function(e){var t=e.changedTouches[0];g=t.pageX-r,c=t.pageY-o;var n=Date.now(),i=n-x,a=null;i<=300&&(Math.abs(g)>=150&&Math.abs(c)<=100?a=g<0?"left":"right":Math.abs(c)>=150&&Math.abs(g)<=100&&(a=c<0?"up":"down")),T=!1,y=n;var l=_;m=_;var d=U.getMaxTranslate("page",this);if(y-u<100&&M.parent&&M.page&&M.parent<M.page){v=1e3*U.calSpeed(P,B,c,i),Math.abs(v)>E&&(v=v<0?-E:E);var h=U.updateTransition("page",this,v,R,_,0,d);if(l=_=h.position,D.scrollPosition=-l/M.page*M.foo,T=!0,S=n,window.setTimeout(function(e){return function(){S<=e&&(T=!1)}}(n),1e3*h.time),0!==L.mode){var f=U.getScrollBar();U._setTransitionClass(f,!1,h.transition),U.setTranslate("bar",f,-(M.foo-M.bar)*(l/(M.page-M.parent)),!0),1===L.mode&&(D.hideTimeout=window.setTimeout(function(){f.parentNode.style.opacity="0"},1e3*h.time+L.hideDelay))}z.end(this,{scrollDir:a,totalDistX:g,totalDistY:c,elapsedTime:i,distXIntervals:A,distYIntervals:P,timeIntervals:B,endPosition:l,startPosition:s,transBoundary:d})}e.preventDefault()},!1);for(var V=0,j=n.children.length;V<j;V++)n.children[V];var G=n.appendChild;this.append=n.appendChild=function(e){G.call(n,e),q.add(e)},this.remove=n.removeChild=function(e){e.style.display="none",q.remove(e)},this.update=n.updateChild=function(e){q.update(e)}}});
